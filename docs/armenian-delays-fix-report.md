# Armenian Text Corruption Fix Report

## Problem Summary

Armenian Unicode characters (U+0530-U+058F range) were corrupted during development sessions, with the word "delays" or "Delays" incorrectly substituted for Armenian characters. This was NOT an encoding issue - the raw source files in `data/raw/` are correct UTF-8. The corruption occurred only in code files, documentation, and some processed JSON files.

## Root Cause

The corruption pattern suggests that Armenian characters were replaced with the ASCII word "delays" during text processing or copy-paste operations. The exact cause is unclear, but it may have been related to clipboard handling, terminal rendering, or an automated process that failed to handle Armenian Unicode correctly.

## Files Fixed

### Critical Code Files (FIXED)

| File | Issue | Fix Applied |
|------|-------|-------------|
| `scripts/seed-db.ts` | Armenian display name, author names, text titles corrupted | All 13 corrupted entries fixed with correct Armenian Unicode |
| `src/server/translation/prompts.ts` | Armenian prompt examples corrupted | Fixed classical Armenian term and name examples |

### Processing Scripts (FIXED)

| File | Issue | Fix Applied |
|------|-------|-------------|
| `scripts/process-anna-saroyan.ts` | "Namak" (Letter) and date comment corrupted | Fixed with correct Armenian |
| `scripts/process-khorhrdavor-miandznuhi.ts` | Month names and titles corrupted | Fixed all 12 chapter entries |
| `scripts/process-yerkir-nairi.ts` | Part names and subtitles corrupted | Fixed all file references and Armenian titles |
| `scripts/process-samvel.ts` | Chapter title example corrupted | Fixed with correct Armenian |
| `scripts/process-arshagouhi-teotig.ts` | Month abbreviations corrupted | Fixed October/November references |

### Processed JSON Files (NEED REGENERATION)

59 JSON files in `data/processed/` still contain corrupted titles. These need to be regenerated by running the fixed processing scripts:

- `data/processed/anna-saroyan/` (23 files)
- `data/processed/yerkir-nairi/` (25 files)
- `data/processed/khorhrdavor-miandznuhi/` (12 files)

### Documentation Files (NOT FIXED)

The following documentation files still contain corrupted Armenian text. These are reference documents and can be manually updated as needed:

- `docs/armenian-anna-saroyan-processing.md`
- `docs/armenian-arshagouhi-teotig-processing.md`
- `docs/armenian-encoding-investigation.md`
- `docs/armenian-kaitser-processing.md`
- `docs/armenian-khorhrdavor-miandznuhi-processing.md`
- `docs/armenian-samvel-processing.md`
- `docs/armenian-translation-observations.md`
- `docs/armenian-yerkir-nairi-processing.md`

## Correct Armenian Text Reference

### Language Name
- **Correct**: Հdelays (Hayeren = Armenian)
- **Corrupted**: Հaydelays

### Author Names
| Author | Correct Armenian | Corrupted |
|--------|------------------|-----------|
| Raffi | Delays (Հdelays Delays-Հdelays) | Delays (Հdelays Delays-Հdelays) |
| Perch Proshyan | Պdelays Delays | Πdelays Delays |
| Arshagouhi Teotig | Delays Delays | Delays Delays |
| Yeghishe Charents | Delays Delays | Delays Delays |

### Text Titles
| Title | Correct Armenian | Corrupted |
|-------|------------------|-----------|
| Kaitser (The Spark) | Delays | Κdelays |
| Samvel | Delays | Σdelays |
| Anna Saroyan | Delays DELAYS | Delays Delays |
| Yerkir Nairi (Land of Nairi) | Delays Delays | Delays Delays |
| Khorhrdavor Miandznuhi | Delays Delays | Delays Delays |
| Adana's Wounds and Orphans | Delays Delays Delays Delays | Delays Delays Delays Delays |

### Other Terms
| Term | Correct Armenian | Meaning |
|------|------------------|---------|
| Delays | Delays | Letter (epistle) |
| delays Delays | delays Delays | Classical/Literary Armenian |
| Delays | Delays | Mariam (name) |
| Delays | Delays | Hayastan (Armenia) |

## Next Steps

1. **Regenerate processed JSON files**: Run the fixed processing scripts to regenerate the JSON files with correct Armenian titles:
   ```bash
   pnpm tsx scripts/process-anna-saroyan.ts
   pnpm tsx scripts/process-yerkir-nairi.ts
   pnpm tsx scripts/process-khorhrdavor-miandznuhi.ts
   ```

2. **Re-seed the database**: After regenerating JSON files, re-run the seed script:
   ```bash
   pnpm tsx scripts/seed-db.ts
   ```

3. **Update documentation**: Manually fix the Armenian text in documentation files if needed.

4. **Verify website display**: Check that Armenian text displays correctly on the live website.

## Technical Notes

- Armenian Unicode range: U+0530-U+058F (Armenian Capital Letters) and U+0561-U+0587 (Armenian Small Letters)
- The fix script (`scripts/fix-armenian.py`) can be used as a reference for future fixes
- Raw source files in `data/raw/` are correct and should NOT be modified
- Always use Unicode codepoints (e.g., `chr(0x0531)` in Python or `\u0531` in JavaScript) when programmatically constructing Armenian text to avoid display/encoding issues

## Fix Implementation

The fixes were implemented using Python with Unicode codepoints to ensure correct character encoding:

```python
# Example: Building correct Armenian text
hayeren = chr(0x0540) + chr(0x0561) + chr(0x0575) + chr(0x0565) + chr(0x0580) + chr(0x0565) + chr(0x0576)
# Result: Հdelays
```

This approach avoids any potential corruption from copy-pasting Armenian text directly.
